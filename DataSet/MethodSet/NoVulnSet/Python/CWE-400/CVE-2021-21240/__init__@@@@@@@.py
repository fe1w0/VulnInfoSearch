def __init__(self, credentials, host, request_uri, headers, response, content, http):
    from urllib import urlencode
    Authentication.__init__(self, credentials, host, request_uri, headers, response, content, http)
    challenge = auth._parse_www_authenticate(response, 'www-authenticate')
    service = challenge['googlelogin'].get('service', 'xapi')
    if service == 'xapi' and request_uri.find('calendar') > 0:
        service = 'cl'
    auth = dict(Email=credentials[0], Passwd=credentials[1], service=service, source=headers['user-agent'])
    (resp, content) = self.http.request('https://www.google.com/accounts/ClientLogin', method='POST', body=urlencode(auth), headers={'Content-Type': 'application/x-www-form-urlencoded'})
    lines = content.split('\n')
    d = dict([tuple(line.split('=', 1)) for line in lines if line])
    if resp.status == 403:
        self.Auth = ''
    else:
        self.Auth = d['Auth']