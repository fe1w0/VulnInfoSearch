@test_util.run_in_graph_and_eager_modes
def testParallelConcatFailsWithRankZeroShape(self):
    op = array_ops.ParallelConcat
    para = {'shape': 0, 'values': [1]}

    def func():
        y = op(**para)
        return y
    with self.assertRaisesRegex(Exception, '(rank|dimension) of .* must be greater than .* 0'):
        func()