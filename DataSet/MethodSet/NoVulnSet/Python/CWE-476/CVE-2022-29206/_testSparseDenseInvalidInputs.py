def _testSparseDenseInvalidInputs(self, a_indices, a_values, a_shape, b, expected_error=''):
    with self.assertRaisesRegex((ValueError, errors_impl.InvalidArgumentError), expected_error):
        a = sparse_tensor.SparseTensor(a_indices, a_values, a_shape)
        self.evaluate(sparse_ops.sparse_add(a, b))
    with self.assertRaisesRegex((ValueError, errors_impl.InvalidArgumentError), expected_error):
        self.evaluate(sparse_ops.gen_sparse_ops.sparse_tensor_dense_add(a_indices, a_values, a_shape, b))