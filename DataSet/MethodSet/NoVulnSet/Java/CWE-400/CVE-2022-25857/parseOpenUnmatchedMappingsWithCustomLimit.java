public class FuzzyStackOverflowTest {
  public void parseOpenUnmatchedMappingsWithCustomLimit() {
    try {
      LoaderOptions options = new LoaderOptions();
      options.setNestingDepthLimit(1000);
      Yaml yaml = new Yaml(options);
      String strYaml = Util.getLocalResource("fuzzer/YamlFuzzer-4626423186325504");
      yaml.load(strYaml);
      fail("Should report invalid YAML");
    } catch (YAMLException e) {
      assertEquals("Nesting Depth exceeded max 1000", e.getMessage());
    }
  }
}