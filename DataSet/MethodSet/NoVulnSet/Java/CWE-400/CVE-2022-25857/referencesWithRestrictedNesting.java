public void referencesWithRestrictedNesting() {
    // without alias restriction this size should occupy tons of CPU, memory and time to parse
    int depth = 35;
    String bigYAML = createDump(depth);
    // Load
    long time1 = System.currentTimeMillis();
    LoaderOptions settings = new LoaderOptions();
    settings.setMaxAliasesForCollections(1000);
    settings.setAllowRecursiveKeys(true);
    settings.setNestingDepthLimit(depth);
    Yaml yaml = new Yaml(settings);
    try {
        yaml.load(bigYAML);
        fail();
    } catch (Exception e) {
        assertEquals("Nesting Depth exceeded max 35", e.getMessage());
    }
    long time2 = System.currentTimeMillis();
    float duration = (time2 - time1) / 1000;
    assertTrue("It should fail quickly. Time was " + duration + " seconds.", duration < 1.0);
}