    final public static class Decoder implements Parser.Decoder {
        /*package*/ BinaryReconstructor reconstructor;
        private Decoder.Callback onDecodedCallback;
        private static boolean isPayloadValid(int type, Object payload) {
            switch (type) {
                case Parser.CONNECT:
                    return payload instanceof JSONObject;
                case Parser.ERROR:
                    return payload instanceof String;
                case Parser.DISCONNECT:
                    return payload == null;
                case Parser.EVENT:
                case Parser.BINARY_EVENT:
                    return payload instanceof JSONArray
                            && ((JSONArray) payload).length() > 0
                            && !((JSONArray) payload).isNull(0);
                case Parser.ACK:
                case Parser.BINARY_ACK:
                    return payload instanceof JSONArray;
                default:
                    return false;
            }
        }
}