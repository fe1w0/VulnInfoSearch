buf += res;
			}
		}

		if (fifo_out) {
			if (in_buf == 0) {
				