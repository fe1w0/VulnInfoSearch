do { \
  static ONION_THREAD_LOCAL time_t last_func_call = 0; \
  static ONION_THREAD_LOCAL unsigned int func_calls_since = 0; \
  if (difftime(time(0), last_func_call) >= seconds) { \
    func(__VA_ARGS__, func