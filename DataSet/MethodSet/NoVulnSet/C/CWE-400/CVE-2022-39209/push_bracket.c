static void push_bracket(subject *subj, bool image, cmark_node *inl_text) {
  bracket *b = (bracket *)subj->mem->calloc(1, sizeof(bracket));
  if (subj->last_bracket != NULL) {
    subj->last_bracket->bracket_after = true;
    b->in_bracket_image0 = subj->last_bracket->in_bracket_image0;
    b->in_bracket_image1 = subj->last_bracket->in_bracket_image1;
  }
  b->image = image;
  b->active = true;
  b->inl_text = inl_text;
  b->previous = subj->last_bracket;
  b->previous_delimiter = subj->last_delim;
  b->position = subj->pos;
  b->bracket_after = false;
  if (image) {
    b->in_bracket_image1 = true;
  } else {
    b->in_bracket_image0 = true;
  }
  subj->last_bracket = b;
}