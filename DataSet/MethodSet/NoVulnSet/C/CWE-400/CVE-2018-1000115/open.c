  if (c->hdrbuf)
            free(c->hdrbuf);
        if (c