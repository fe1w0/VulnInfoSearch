LOG_ERR, ("%s", strerror(errno)));
		goto bail;
	}

	if (ret == 0) {
		LOG(LOG_ERR, ("EOF while reading packet (len=%d)", len));
		goto bail;
	}

	tmpbuf_pos += ret;

	if (tmpbuf_pos == len