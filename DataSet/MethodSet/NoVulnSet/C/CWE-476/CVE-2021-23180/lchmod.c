 * Range check everything...
  */

  if (fp == NULL || buf == NULL || buflen < 2)
    r