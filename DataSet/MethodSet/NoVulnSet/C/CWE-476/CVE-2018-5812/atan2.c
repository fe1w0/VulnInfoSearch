RARY_BUILD
    checkCancel();
#endif
    for (col=0; col < width; col++) {
      if ((val = BAYER(row,col) - black) < 0) val = 0;
      val = v