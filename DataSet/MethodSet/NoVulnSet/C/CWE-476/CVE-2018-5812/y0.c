e + row*raw_width;
    nblocks = MIN (8, raw_height-row) * raw_