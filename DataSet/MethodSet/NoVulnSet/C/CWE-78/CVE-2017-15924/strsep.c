ar *action;
    int pos = 0;

    while (pos < len 