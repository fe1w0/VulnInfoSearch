r case, num_attr is the number of attributes affected by
 * this rule, and state is an array listing them.  The 