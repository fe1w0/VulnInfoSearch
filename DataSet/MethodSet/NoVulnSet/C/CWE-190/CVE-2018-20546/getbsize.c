 -1 if an error occurred.
 */