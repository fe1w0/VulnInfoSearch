and can't use realloc */
        newsh = s_malloc(hdrlen+newlen+1);
        if (new