ecking is performed, so insufficient memory will
   result in a buffer overrun.
   