static Jsi_RC jsi_ArrayIndexSubCmd(Jsi_Interp *interp, Jsi_Value *args, Jsi_Value *_this,Jsi_Value **ret, Jsi_Func *funcPtr, int op) {
    int istart = 0, n, i = 0, dir=1, idx=-1;
    Jsi_Value *seq = Jsi_ValueArrayIndex(interp, args, 0),
        *start = Jsi_ValueArrayIndex(interp, args, 1);
    Jsi_Obj *obj = _this->d.obj;
    if (_this->vt != JSI_VT_OBJECT || !Jsi_ObjIsArray(interp, _this->d.obj))
        return Jsi_LogError("expected array object");

    if (!seq) {
        goto bail;
    }
    
    n = jsi_SizeOfArray(interp, obj);    
    if (n == 0) {
        goto bail;
    }
    Jsi_Number nstart;
    if (op == 2) {
        istart = n-1;
    }
    if (start && Jsi_GetNumberFromValue(interp,start, &nstart)==JSI_OK) {
        istart = (int)nstart;
        if (istart > n)
            goto bail;
        if (istart < 0)
            istart = (n+istart);
        if (istart<0)
            goto bail;
    }
    if (op == 2) {
        istart = n-1;
        dir = -1;
    }
    Jsi_ObjListifyArray(interp, obj);
    for (i = istart; ; i+=dir)
    {
        if ((dir>0 && i>=n) || (dir<0 && i<0) || i>=(int)obj->arrCnt)
            break;
        if (obj->arr[i] && Jsi_ValueCmp(interp, obj->arr[i], seq, JSI_CMP_EXACT)==0) {
            idx = i;
            break;
        }
    }
bail:
    if (op == 3)
        Jsi_ValueMakeBool(interp, ret, (idx!=-1));
    else
        Jsi_ValueMakeNumber(interp, ret, idx);
    return JSI_OK;
}