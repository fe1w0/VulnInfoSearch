and all the
 * references must be substituted with the new pointer returned by th