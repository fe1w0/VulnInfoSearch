aved into a malloc()ed
// buffer stored in *output. The return value is the number of sam