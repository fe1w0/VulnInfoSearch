nt overflow by constructing the dense shape separately
    TensorShape dense_shape;
    const auto input_shape_flat = input_shap