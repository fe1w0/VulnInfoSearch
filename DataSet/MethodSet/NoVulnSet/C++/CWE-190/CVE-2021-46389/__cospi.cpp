gh assigning to the same buffer
  for( unsigned long i=0; i<np; i++ 