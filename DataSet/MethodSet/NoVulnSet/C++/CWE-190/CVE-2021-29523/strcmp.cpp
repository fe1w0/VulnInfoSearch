nst auto& shape = sp_iter->second.shape;
      