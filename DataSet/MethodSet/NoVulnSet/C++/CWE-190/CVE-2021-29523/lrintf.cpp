nk < 0) rank = shapes_to_conc;