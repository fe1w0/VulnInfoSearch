d < rank; ++d) {
        preconcat_sh