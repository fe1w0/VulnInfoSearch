work with outputs of rank > 2.
template <class T>
Status OutputSparse(const BatchedMap<T>& per_batch_cou