    int output_bucket = 0;
    int stride = 1;
    for (int k = (lookup_rank - 1) - 1; k