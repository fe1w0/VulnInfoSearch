{
      // only index if indices are valid
      if (current_output_offset + k < 0) continue;
      if (curr