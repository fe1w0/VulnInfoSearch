 // n_dim and input.rank are equivalent.
  ShapeHandle inpu