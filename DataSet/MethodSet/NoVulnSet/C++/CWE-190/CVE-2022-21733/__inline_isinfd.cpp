re ngram ends either with the
        // token or with the right pad.
        ngram->append(data[data_start_i