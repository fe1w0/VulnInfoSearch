lock_shape_product);
  }
  external_output_shape.AddDim(output_shape);

  int64_t input_batch_size = orig_input_tensor.dim_size(0);
  for (int block_dim = 0; block_dim <