shape[dim] != 1) {
      break;
    }
  }

  // Determine the 