  } else {  // method_name == "nearest"
              for (int d = 0; d < depth; ++d) {
                int