, pad_value, output);
    }
  }

 private:
  // Collapses adjacent 