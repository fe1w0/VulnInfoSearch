  ++i;
      } else {
        // If not padded, find the next dimension that is padded and collapse
        // all dimension