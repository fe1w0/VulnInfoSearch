 collapsed_output_shape) {
    bool collapsed = false;
    typename 