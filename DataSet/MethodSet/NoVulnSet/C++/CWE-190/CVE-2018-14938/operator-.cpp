 EXTRACT_16BITS(ptr + 12);

    ptr += 14;
    len -= 14;

    cbs->HandleEthernet(*this, &hdr, ptr, len);

    switch (hdr.type) {
    case ETHERTYPE_IP:
	handle_ip(ptr, len);
	return;
    case ETHERTYPE_IPV6:
	handle_ip6(ptr, len);
