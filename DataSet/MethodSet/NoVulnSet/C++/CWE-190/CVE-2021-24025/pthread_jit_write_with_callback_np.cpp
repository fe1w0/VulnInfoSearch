g_context->getTransport();
  if (!transport || !transport->isUploadedFile(filename)) {
    return false;
  }

  CHECK_PATH_FALSE(destination, 2);

  if (HHVM_FN(rename)(filename, destination)) {
    return true;
  }

  // If rename didn't work, fall back to copy f