 for CPU.
template <typename T, typename Index, typename InitialValueF,
          typena