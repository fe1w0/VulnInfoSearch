dex = out_index + 1;
      out_index = next_index;
    }
  }
};

#if GOOGLE_CUDA 