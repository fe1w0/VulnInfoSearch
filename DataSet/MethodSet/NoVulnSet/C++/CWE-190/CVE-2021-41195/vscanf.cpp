flat = output->flat_outer_dims<T>();
      auto data_ptr = input.templat