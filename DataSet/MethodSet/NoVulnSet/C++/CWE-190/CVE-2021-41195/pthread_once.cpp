egments = output.dimension(0);
    ReductionF reduction;
    for (int64_t i = 0; i < N; ++i) {
      Index j = internal::SubtleMustCopy(segment_ids(i));
      if (j