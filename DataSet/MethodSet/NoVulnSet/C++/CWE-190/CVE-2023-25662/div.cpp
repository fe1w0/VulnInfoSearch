ptr) {
    c->set_output(0, c->UnknownShape());
    return OkStatus();
  }

  // Find our value of the rank.
  int64_t rank;
  if (c->RankKnown(input)) {
    ran