R(c->WithRankAtLeast(
          params_shape, axis < 0 ? -axis : axis + 1, &unused));

      // Note, batch_dims can be negative.
      int32_t batch_dims;
      TF_RETURN_IF_ERROR(c->GetAttr("batch_dim