RETURN_IF_ERROR(c->WithRank(input, num_dims, &input));
  TF_R