me rank as input. Note that each
        // output shape can be diff