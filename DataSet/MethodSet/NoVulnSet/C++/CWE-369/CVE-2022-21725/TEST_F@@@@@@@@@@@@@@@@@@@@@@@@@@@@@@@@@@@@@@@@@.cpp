TEST_F(OpLevelCostEstimatorTest, PredictResourceVariableOps) {
  TestOpLevelCostEstimator estimator;
  estimator.SetDeviceInfo(DeviceInfo(/*gigaops=*/1, /*gb_per_sec=*/1));

  {
    OpContext op_context;
    op_context.op_info.set_op("AssignVariableOp");
    DescribeDummyTensor(op_context.op_info.add_inputs());
    DescribeTensor1D(100, op_context.op_info.add_inputs());
    auto cost = estimator.PredictCosts(op_context);
    EXPECT_EQ(Costs::Duration(400), cost.memory_time);
    EXPECT_EQ(Costs::Duration(0), cost.compute_time);
    EXPECT_EQ(Costs::Duration(400), cost.execution_time);
    EXPECT_FALSE(cost.inaccurate);
    EXPECT_EQ(cost.temporary_memory, 0);
    EXPECT_EQ(cost.persistent_memory, 0);
  }

  {
    OpContext op_context;
    op_context.op_info.set_op("AssignSubVariableOp");
    DescribeDummyTensor(op_context.op_info.add_inputs());
    DescribeTensor1D(100, op_context.op_info.add_inputs());
    auto cost = estimator.PredictCosts(op_context);
    EXPECT_EQ(Costs::Duration(400), cost.memory_time);
    EXPECT_EQ(Costs::Duration(100), cost.compute_time);
    EXPECT_EQ(Costs::Duration(400), cost.execution_time);
    EXPECT_FALSE(cost.inaccurate);
  }
}