ensor with shape
// (batch, ox, oy, oz) if has_side_input is set, and two scaling te