    out_mat.array().rowwise() /= out_count.transpose().array();
  }

 private:
