ybe allocate a temporary workspace of [rest_size, depth] shape.
    Tensor scratch_rest_by_depth;
 