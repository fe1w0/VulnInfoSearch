                  context->allocate_temp(scratch_dtype, {rest_size, depth},
                                            &scr