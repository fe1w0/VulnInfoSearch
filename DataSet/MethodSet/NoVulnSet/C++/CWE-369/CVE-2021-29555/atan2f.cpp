th = x.reshape(rest_by_depth).tem;