x->allocate_temp(input.dtype(), TensorShape(post_shuffle(input)),
                                &input_shuffled));
    inp