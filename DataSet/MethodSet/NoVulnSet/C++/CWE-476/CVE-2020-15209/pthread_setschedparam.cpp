prevent this scenario. The earliest place we can check this is in
// `AllocateTensors`, hence the test check