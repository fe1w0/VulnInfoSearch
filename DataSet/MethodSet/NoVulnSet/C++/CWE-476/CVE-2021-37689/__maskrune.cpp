 are 1 except
  // last one.
  // Also, val tensor must be of 