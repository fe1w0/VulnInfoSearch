t_shape.set_dim(diag_rank - 1, n;