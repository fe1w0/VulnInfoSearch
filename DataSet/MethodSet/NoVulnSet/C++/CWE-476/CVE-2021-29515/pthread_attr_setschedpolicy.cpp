const int diag_rank = diagonal_shape.dims();
    const Eigen::Index num_diags = upper_diag_in