nsorShape& diagonal_shape = diagonal.shape();
    const int diag_rank = diagonal_sha