the best constant in cost_per_batch.
    const Eigen::Index num_diags = upper_diag_i