          if (solver.info() != Eigen::Success) {
                invalid_input_index = batch_index;
                return;
              }

              // G