dim = (rank == 2) ? 0 : 1;
 