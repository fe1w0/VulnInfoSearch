s_after +=
          static_cast<int>(input_node->device() != output_node->device());
    }
  }
  if (num_cross_afte