if (num_cross_after > num_cross_before) {
    return false;
  }

  if ((is_identity |