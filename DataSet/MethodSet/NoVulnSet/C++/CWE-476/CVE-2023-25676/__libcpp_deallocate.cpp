d(c->input(i))) {
          return errors::InvalidArgument(
              "All input shapes must be fully defined.");
        }
        if (c->Rank(c->input(i)) < 1) {
          return errors::InvalidArgument(
              "The rank of all input shapes must be greater than 0, "
              "but input ",
              i, " had rank ", c->Rank(c->input(i)), ".");
        }
        DimensionHandle unused;
        if (!c->WithValue(c->Dim(c->input(i), 0), 1, &unused).ok()) {
          return errors: