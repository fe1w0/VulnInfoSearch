nk of the input and the value of perm, we can return
  // all shape information, otherwise we can only return rank information,
  // but no inf