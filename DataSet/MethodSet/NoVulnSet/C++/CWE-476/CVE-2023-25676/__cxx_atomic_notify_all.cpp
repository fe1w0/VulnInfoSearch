dim range [-1 * input rank, input rank) is allowed. However,
      // the op implementation has a stricter bound for batch_