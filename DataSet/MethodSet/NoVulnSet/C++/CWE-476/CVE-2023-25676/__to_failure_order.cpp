th_shape_t->NumElements());
      }

      auto h_values = hypothesis_shape_t->flat<int64_t>();
      auto t_values = truth_shape_t->flat<int64_t>();
      std::vector<DimensionHandle> dims(hypothesis_shape_t->NumElements() - 1);
      for (int i = 0; i < dims.size(); ++i) {
        dims[i] = c->MakeDim(std::max(h_