R(c->WithRank(c->input(0), dims, &input));

      int32_t block_size;
      TF_RETURN_IF_ERROR(c->GetAttr("block_size", &block