Rank(out);
      TF_RETURN_IF_ERROR(c->WithRankAtMost(in, out_rank, &i