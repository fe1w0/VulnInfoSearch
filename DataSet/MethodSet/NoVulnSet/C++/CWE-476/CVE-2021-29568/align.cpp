P_REQUIRES(
        ctx, TensorShapeUtils::IsVector(shape_tensor.shape()),
        error