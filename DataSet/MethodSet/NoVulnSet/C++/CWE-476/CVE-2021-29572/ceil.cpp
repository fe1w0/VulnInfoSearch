use
  // num_examples here, as empirically Shard() creates the right amount of
  // threads based on the prob