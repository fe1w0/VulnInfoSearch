] = res_num;
    ++res_num;
  }

  // We pre-allocate t