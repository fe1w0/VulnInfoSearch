    }

    // Size validations.
    const TensorShape& diagonal_shape = diagonal.shape();
    const i