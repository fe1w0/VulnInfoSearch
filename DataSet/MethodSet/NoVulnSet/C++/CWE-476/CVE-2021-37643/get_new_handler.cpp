  const int32_t max_diag_len =
        std::min(num_rows