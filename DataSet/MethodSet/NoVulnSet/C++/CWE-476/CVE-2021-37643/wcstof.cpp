rShapeUtils::IsVector(diag_index.shape()),
                  er