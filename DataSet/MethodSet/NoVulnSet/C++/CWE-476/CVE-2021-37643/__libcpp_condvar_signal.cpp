       diagonal_shape.dim_size(diag_rank - 2) == num_diags,
                errors::InvalidAr