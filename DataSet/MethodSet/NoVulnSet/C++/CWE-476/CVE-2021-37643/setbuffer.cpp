nst int diag_len = std::min(num_rows;