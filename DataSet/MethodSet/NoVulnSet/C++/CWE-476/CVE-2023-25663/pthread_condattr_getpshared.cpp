**********************
// Note that this op may have an optional third input. If present, it represents
// a shape value. It indi