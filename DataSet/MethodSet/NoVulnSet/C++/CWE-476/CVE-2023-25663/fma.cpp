cast<int64_t>(values.size())}),
                       &lengths_tensor));
    auto lengths_tensor_t = lengths_tensor->vec<int64_t>();

    TensorShape output_shape;
    TensorShape output_shape_except0;
    for (std::size_t i = 0; i < values.size(); ++i) {
      TensorShape value_