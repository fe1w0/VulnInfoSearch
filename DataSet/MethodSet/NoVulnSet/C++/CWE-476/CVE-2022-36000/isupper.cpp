 // Allocate outputs.
  std::set<int> unused_inputs;
  for (int input_idx = 0; inpu