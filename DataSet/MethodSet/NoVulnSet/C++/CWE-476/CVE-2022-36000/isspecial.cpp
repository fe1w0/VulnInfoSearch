 an input buffer we can reuse for this output.
    bool reused_input = false;
    if 