t_rank = -1;
  for (int i = 0; i < NumMatrixInputs(context); ++i) {
    const 