void spider_db_mbase::fetch_and_print_warnings(struct tm *l_time)
{
  DBUG_ENTER("spider_db_mbase::fetch_and_print_warnings");

  if (spider_param_dry_access() || db_conn->status != MYSQL_STATUS_READY ||
      db_conn->server_status & SERVER_MORE_RESULTS_EXISTS)
    DBUG_VOID_RETURN;

  if (mysql_real_query(db_conn, SPIDER_SQL_SHOW_WARNINGS_STR,
                       SPIDER_SQL_SHOW_WARNINGS_LEN))
    DBUG_VOID_RETURN;

  MYSQL_RES *res= mysql_store_result(db_conn);
  if (!res)
    DBUG_VOID_RETURN;

  uint num_fields= mysql_num_fields(res);
  if (num_fields != 3)
  {
    mysql_free_result(res);
    DBUG_VOID_RETURN;
  }

  MYSQL_ROW row= mysql_fetch_row(res);
  while (row)
  {
    fprintf(stderr,
            "%04d%02d%02d %02d:%02d:%02d [WARN SPIDER RESULT] from [%s] %ld "
            "to %ld: %s %s %s\n",
            l_time->tm_year + 1900, l_time->tm_mon + 1, l_time->tm_mday,
            l_time->tm_hour, l_time->tm_min, l_time->tm_sec, conn->tgt_host,
            (ulong) db_conn->thread_id, (ulong) current_thd->thread_id, row[0],
            row[1], row[2]);
    row= mysql_fetch_row(res);
  }
  mysql_free_result(res);

  DBUG_VOID_RETURN;
}