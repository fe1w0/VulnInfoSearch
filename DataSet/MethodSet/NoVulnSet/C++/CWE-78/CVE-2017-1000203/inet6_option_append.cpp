  bool needesc = false;
   for (const char *p = patbuf; *p; p++)
      if (st