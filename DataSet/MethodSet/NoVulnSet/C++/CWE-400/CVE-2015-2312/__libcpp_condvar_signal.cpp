he segment map because we lazily initialize segments when they are
  // first requested, but 