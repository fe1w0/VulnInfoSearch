lf is small, so we
  // need to defend agaisnt DoS attacks based