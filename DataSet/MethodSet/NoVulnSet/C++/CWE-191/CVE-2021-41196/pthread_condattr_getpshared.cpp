rocedure is repeated for every spatial dimension in the
      // nested loops below.
      int pindex, psize;
      std::array<in