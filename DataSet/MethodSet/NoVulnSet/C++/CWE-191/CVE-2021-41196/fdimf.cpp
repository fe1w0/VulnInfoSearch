ocedure is repeated for every sp;