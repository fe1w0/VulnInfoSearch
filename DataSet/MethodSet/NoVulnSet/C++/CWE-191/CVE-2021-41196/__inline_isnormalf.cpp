 and reduce the broadcast size.
      //
      // The same procedure is repeated for every spatial dimension in the
      // nested loo