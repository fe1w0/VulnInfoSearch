rker_threads());

    auto shard = [&params, &in_mat, &out_mat,