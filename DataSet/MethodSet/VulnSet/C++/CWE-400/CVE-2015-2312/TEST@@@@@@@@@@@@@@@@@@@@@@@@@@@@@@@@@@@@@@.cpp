TEST(Encoding, DefaultFloatPlusNan) {
  MallocMessageBuilder message;
  auto root = message.initRoot<TestDefaults>();

  root.setFloat32Field(kj::nan());
  root.setFloat64Field(kj::nan());

  float f = root.getFloat32Field();
  EXPECT_TRUE(f != f);

  double d = root.getFloat64Field();
  EXPECT_TRUE(d != d);
}