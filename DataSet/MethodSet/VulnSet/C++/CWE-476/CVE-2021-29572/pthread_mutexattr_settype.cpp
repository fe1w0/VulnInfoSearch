ce num_examples can be at max an int.
  const int num_examples = static_cast<int>(example_weight