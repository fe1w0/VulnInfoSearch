nd allocates and initializes the delta weights.
  const auto initialize_weights =
      [&](co