on't increase the number of edges that cross
  // device boundaries.
  if ((num_inputs == 1 && num_ou