hreshold will be restored from a thread-pool.
const int64_t kLargeShapeThreshold = 