F_RETURN_IF_ERROR(
          context->allocate_output(idx, restored_full_shape, &restored_tensor