each batch in parallel.
    auto worker_threads = *(ctx->device()->