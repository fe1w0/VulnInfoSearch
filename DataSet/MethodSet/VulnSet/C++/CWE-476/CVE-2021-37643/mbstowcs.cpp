ax_diag_len =
        std::min(num_rows + std::min(upper_diag_index, 0),