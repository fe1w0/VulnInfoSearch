);
  const int diag_len = std::min(nu