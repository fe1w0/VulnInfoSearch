st not be larger than upper_diag;