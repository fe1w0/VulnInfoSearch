 for (Eigen::Index m = 0; m < num_diags; ++m) {
          const Eigen::Index diag_index = upper_dia