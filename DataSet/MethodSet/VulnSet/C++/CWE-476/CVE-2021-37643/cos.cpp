device,                       \
      typename TTypes<T>::ConstTensor& diag,                               