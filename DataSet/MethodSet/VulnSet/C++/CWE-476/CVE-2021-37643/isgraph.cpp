   if (TensorShapeUtils::IsVector(diag_index.shape())) {
        auto diag_index_si