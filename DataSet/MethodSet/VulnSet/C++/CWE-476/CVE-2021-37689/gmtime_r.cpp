auto tail_type = type1.dyn_cast<ShapedType>();
  auto full_type = type