x,
                   ctx->allocate_output(
                       1, TensorShape({static_cast<int64_t>(values.size())}),
                       &lengths_tensor));
    auto lengths_tensor_t = lengths_tensor->vec<int64_t>();

    TensorShape output_shape;
    TensorShape output_sha