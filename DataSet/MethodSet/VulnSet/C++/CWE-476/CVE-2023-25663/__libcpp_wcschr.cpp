r array uses a "per-step" resource
// manager which ensures that correct garbage collection on error or
// successful completio