      if (!ta_element_shape.unknown_rank()) {
        std::vector<int64_t> dims;
        for (auto dim : shape_