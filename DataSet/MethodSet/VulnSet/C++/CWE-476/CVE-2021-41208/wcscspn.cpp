dx) {
      std::vector<float> cum_grad;
      s