gonal.flat<T>();
    functor::MatrixDiag<Device, 