upper_diag_index range."));

    const Eigen::Index max_diag_len = diagonal_shape.dim_size(dia