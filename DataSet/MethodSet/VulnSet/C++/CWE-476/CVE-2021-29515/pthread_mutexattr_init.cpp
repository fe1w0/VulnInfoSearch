 diag_len = std::min(num_rows + std::min(0, diag_index),
                               