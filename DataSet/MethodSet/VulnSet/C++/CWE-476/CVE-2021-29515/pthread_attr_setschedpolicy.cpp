   lower_diag_index == upper_diag_index ||
                    diagonal_shape.dim_size(diag_r