Types<T>::ConstTensor& diag,
                      typename TTypes<T, 3>::Tensor& output,
      