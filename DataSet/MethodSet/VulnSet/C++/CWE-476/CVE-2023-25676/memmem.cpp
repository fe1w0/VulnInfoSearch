d the value of perm, we can return
  // all shape information, otherwise we can only return rank information,
  // but no information for the d