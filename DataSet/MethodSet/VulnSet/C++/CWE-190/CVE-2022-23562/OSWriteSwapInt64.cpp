pe, &out));
    if (size == 0) return;
    auto flat = out->flat<T>();
    functor::RangeFunctor<Device, T>()(context, size, start, delta, flat);
  }
};

#define REGISTER_KERNEL(DEV, DEV_TYPE, TYPE)                