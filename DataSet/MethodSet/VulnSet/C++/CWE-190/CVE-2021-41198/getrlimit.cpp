im_size(i);
    }

    functor::ReduceAndReshape<Device, T, NDIM,