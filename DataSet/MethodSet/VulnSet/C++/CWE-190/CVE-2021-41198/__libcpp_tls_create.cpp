// --------------------------------------------------------------------------
template <typename Device, typename Tmultiples>
