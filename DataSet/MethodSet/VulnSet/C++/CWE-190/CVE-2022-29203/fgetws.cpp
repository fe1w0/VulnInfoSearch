lock_dim < block_dims; ++block_dim) {
    block_shape_product