 the output will be treated as
  // having this shape, of rank 2 + internal_block_dims.
  TensorShape internal_