] != 0 ||
        block_shape[dim] != 1) {
      break;
    }
  }

  // Compute the product o