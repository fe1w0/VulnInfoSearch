  for (int k = (lookup_rank - 1) - 1; k >= 0; k--) {
      output_bucket += indices->dat