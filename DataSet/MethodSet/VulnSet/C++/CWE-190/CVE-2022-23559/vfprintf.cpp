i * lookup_rank;
    int output_bucket = 0;
    int stride = 1;
    for (int k = (loo