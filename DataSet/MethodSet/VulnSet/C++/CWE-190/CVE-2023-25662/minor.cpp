of perm, we can return
  // all shape information, otherwise we can only return rank i