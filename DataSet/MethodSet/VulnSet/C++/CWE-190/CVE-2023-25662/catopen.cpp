 // n_dim and input.rank are equiva;