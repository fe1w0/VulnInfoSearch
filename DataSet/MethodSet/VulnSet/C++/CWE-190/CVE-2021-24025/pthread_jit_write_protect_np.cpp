or_null<StreamContext>(context)
  );

  if (!file) {
    return false;
  }

  if (flags & LOCK_EX) {
    // Check to make su