             bool& wouldblock) {
  CHECK_HANDLE(handle, f);
  int act;
  wouldblock = false;

  act = operation & 3;
  if (act < 1 || act > 3) {
    raise_invalid_argument_warning("operation: %d", op