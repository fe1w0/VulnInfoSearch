     for (int d = 0; d < depth; ++d) {
                int closest_x_index = roundf(in_x);
                in