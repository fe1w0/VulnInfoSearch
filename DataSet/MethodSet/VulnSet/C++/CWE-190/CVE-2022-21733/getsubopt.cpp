ng =
          std::max(0, pad_width - (num_ngra