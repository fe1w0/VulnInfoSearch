;
            safe_free(username);
            return rv;
        }
    }

    /** below nonce state dependent 