EQUIRES_ASYNC(
        context, num_indices == input.dim_size(0),
        errors::InvalidArgument(
     