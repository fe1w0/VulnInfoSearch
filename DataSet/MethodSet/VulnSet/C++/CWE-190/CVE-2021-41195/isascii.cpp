e (end <= num_indices) {
      // We initialize next_index to 0 to avoid "warn