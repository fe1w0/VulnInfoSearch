  // Note that the current implementation assumes that segment;