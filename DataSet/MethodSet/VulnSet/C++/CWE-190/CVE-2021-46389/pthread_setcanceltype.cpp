#pragma ivdep
#elif defined(_OPENMP)
#pragma omp parallel for
#endif
  for( unsigned long n=0; n<np; n++ ){
    float v = infptr[n] * max * c;
    buffer[n] = (unsigned char)( (v<max) ? (v<0.0? 0.0 :