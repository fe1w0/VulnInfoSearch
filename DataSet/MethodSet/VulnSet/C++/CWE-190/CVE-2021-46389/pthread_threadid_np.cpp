g between 0-1 more linear than 0-255
  // - assume only 8 bit output for now
  float max = 255.0;

  // S