e the number of columns - limit to our number of channels if necessary
  unsigned int ncols = (matrix.size()>