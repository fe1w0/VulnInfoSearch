     for (int p = p_start; p < p_end && !should_stop; ++p) {
                  for (int h = h_start; h < h_en