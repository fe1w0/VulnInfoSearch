 // Compute pre shuffle dimemnsions.
    auto pre_shuffle = [&](const Tensor& tensor) -> st