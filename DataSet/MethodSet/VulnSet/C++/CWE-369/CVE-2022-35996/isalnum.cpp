te pre shuffle dimemnsions.
    auto pre_shuffle = [&](const Tensor& tensor) -> std::array<i