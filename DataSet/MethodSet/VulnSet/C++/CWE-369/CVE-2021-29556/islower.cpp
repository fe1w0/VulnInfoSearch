nput(0);

  // Use optimized reverse if possible.
  if (NDIMS == 3 && std::is_same<