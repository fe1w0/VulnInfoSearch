(negative for right shift)
  //
  // Assumptions: The following input ranges are assumed
