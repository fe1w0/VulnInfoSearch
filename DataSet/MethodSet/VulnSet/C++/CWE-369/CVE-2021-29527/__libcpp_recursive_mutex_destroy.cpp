ll be processed serially, so we can refill the
// buffer for the next chunk and reuse it, keeping maximum memo