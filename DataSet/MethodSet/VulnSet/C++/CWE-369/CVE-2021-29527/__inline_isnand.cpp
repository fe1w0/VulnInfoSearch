processed serially, so we can refill the
// buffer for the next chunk and reuse i