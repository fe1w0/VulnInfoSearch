 bottom filter
    // patches sampling from outside the borders if it's greater than 1.
    // Most of the logic for sor