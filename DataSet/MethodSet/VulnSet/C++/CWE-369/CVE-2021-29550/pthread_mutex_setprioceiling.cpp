ckprop_element = static_cast<double>(
                    out_backprop_mat.coeffRef(d, out_index));
                double& in