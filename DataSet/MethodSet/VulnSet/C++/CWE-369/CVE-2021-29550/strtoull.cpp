w_end = std::min(row_end, row_max);

        // col sequence.
        for (in