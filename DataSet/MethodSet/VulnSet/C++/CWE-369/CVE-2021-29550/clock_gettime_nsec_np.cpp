HECK_GT(out_count.minCoeff(), 0);
    out_mat.array().rowwise() /= out_coun