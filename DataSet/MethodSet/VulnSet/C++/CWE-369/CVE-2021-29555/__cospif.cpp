typename TTypes<U>::ConstVec scale(scale_input.vec<U>());
    typen