 // Allocate a temporary workspace of [depth] shap;