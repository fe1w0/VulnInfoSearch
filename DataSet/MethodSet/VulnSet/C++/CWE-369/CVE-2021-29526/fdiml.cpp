 auto& strides = params->strides;
  const auto& di