st be at least
         * (wc + 2) x (hc + 2). */
    xrat = w 