lock(&device->io_lock);

	while