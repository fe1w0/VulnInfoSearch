 return filter[(row+top_margin)&15][(col+left_margin)&15];
  if (