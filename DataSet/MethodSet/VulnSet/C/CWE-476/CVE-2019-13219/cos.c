trades off space for speed by forcing a linear search in the
//     non-fast case, except for "sparse" code