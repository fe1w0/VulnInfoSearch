static int server_audit_deinit(void *p __attribute__((unused)))
{
  if (!init_done)
    return 0;

  init_done= 0;
  coll_free(&incl_user_coll);
  coll_free(&excl_user_coll);

  if (output_type == OUTPUT_FILE && logfile)
    logger_close(logfile);
  else if (output_type == OUTPUT_SYSLOG)
    closelog();

  (void) free(big_buffer);
  flogger_mutex_destroy(&lock_operations);
  flogger_mutex_destroy(&lock_atomic);
  flogger_mutex_destroy(&lock_bigbuffer);

  error_header();
  fprintf(stderr, "STOPPED\n");
  return 0;
}