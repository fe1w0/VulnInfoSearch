    assert(c != NULL);

    if (c->msgused > c->hdrsize) {
        void *n